Multi-Container Application with Docker Compose

Objective: Design and deploy a multi-container application using Docker Compose. The application will consist of a Python service and a Redis database service that communicate with each other.

1. Setup & Installation

Install Docker Compose:

sudo apt install docker-compose -y


Start Docker:

sudo systemctl start docker


Create Project Directory:

mkdir question8
cd question8


2. Create the Application File (app.py)

Create a Python script that connects to Redis and increments a counter.

gedit app.py


Content for app.py:

import redis

# Connect to Redis. The host name 'redis' matches the service name in docker-compose.
result = redis.Redis(host='redis', port=6379)

# Increment the 'count' key in Redis
result.incr('count')

# Get the value and print it
print('Count', result.get('count').decode())


3. Create the Dockerfile

Create a Dockerfile to build the Python application image.

gedit Dockerfile


Content for Dockerfile:

FROM python:3.10
RUN pip install redis
COPY app.py .
CMD ["python", "app.py"]


4. Create the Docker Compose File

Create a docker-compose.yml file to define and run the two services (App and Redis).

gedit docker-compose.yml


Content for docker-compose.yml:

version: '3'
services:
  app:
    build: .
    depends_on:
      - redis
  redis:
    image: redis
    volumes:
      - redis-data:/data
volumes:
  redis-data:


5. Build and Run

Run the following command to build the images and start the containers defined in the Compose file.

sudo docker-compose up --build


The output will show the services starting.

Look for the output app_1 | Count 1.

If you stop (Ctrl+C) and run the command again, you should see app_1 | Count 2, proving that the data persists in the Redis volume.
